快速开发H5轻应用

上周临时接到任务，要给公司的培训部门做两个轻应用，一个是签到，一个是考试。

> LAPP (Light App) 即轻应用是一种无需下载、即搜即用的全功能 App，既有媲美甚至超越native app的用户体验，又具备webapp的可被检索与智能分发的特性，将有效解决优质应用和服务与移动用户需求对接的问题。2013年 8月22日，百度在2013年百度世界大会上宣布推出“轻应用”，可实现无需下载[1]  ，即搜即用和通过移动搜索功能----<百度百科>

采用H5开发轻应用，首先推荐采用SAP的模型，这样才能有媲美甚至超越native的优势，SAP模型使的去掉了页面跳转带来的视线转移和中断。

要开发一个好的H5页面，除了采用SAP模型外，要满足两点

1，要能在各种手机屏幕上有匹配UI

2，要满足手机端的UE

3、支持页面的导航

我们先说UI,首先弄清楚给出的设计稿的基准是什么？ 以我们这次的设计稿来说是基于iphone6的设计稿，搞清楚这个，我们在作UI时的度量单位就有了基准。为了适配各种屏幕，我们要用REM作为度量，而不是传统的PX,或者em. 那么这之间的关系是什么？ 见下

公式：rem = document.documentElement.clientWidth * dpr / 10

iphone3gs: 320px / 10 = 32px

iphone4/5: 320px * 2 / 10 = 64px

iphone6: 375px * 2 / 10 = 75px


要使用REM，我们需要给html元素设置font-size.上面的计算，就可以得出我们想要的数值。

对于动态改变根节点html的font-size，我们可以通过css做，也可以通过javascript做。

再说UE,我们知道在h5页面click会有 200~300 ms的延迟，为此可以使用支持tap事件的的zepto库或者引入fastclick库，以去掉这个延迟，使得用户点击快速响应，同时页面上元素的重复点击，从而避免一些逻辑错误。其次对于列表页面，可以引入iscroll库，以支持页面的流畅的滑动加载事件

对于页面导航，可以使用h5的pushState方法，模拟导航。可以预先根据页面结构，定义好路由如
// var route = {"key":"#count"};
// var route = {"key":"#exam"};
// var route = {"key":"#score"};
// var route = {"key":"#scores"};
// var route = {"key":"#share"};

在页面前进时，push路由。然后利用onpopstate，去检测路由，从而实现导航。

还有一个点，就是在iphone上web页面上，非页面加载就存在的元素，其事件是不生效的。需要单独处理。
解决办法有 4 种可供选择：

​将 click 事件直接绑定到目标​元素（​​即 .target）上

将目标​元素换成 <a> 或者 button 等可点击的​元素

​将 click 事件委托到​​​​​非 document 或 body 的​​父级元素上

​给​目标元素加一条样式规则 cursor: pointer;

​推荐后两种。从解决办法来看，​推测在 safari 中，不可点击的元素的点击事件不会冒泡到父级元素。通过添加

 cursor: pointer 使得元素变成了可点击的了。

